{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from \"axios\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\n\nconst apiKey = \"41921784-0571e350d6104826bc1422cb3\";\nconst searchForm = document.getElementById(\"search-form\");\nconst searchInput = document.getElementById(\"search-input\");\nconst loader = document.getElementById(\"loader\");\nconst gallery = document.getElementById(\"gallery\");\nconst btnLoadMore = document.querySelector('[data-action=\"load-more\"]');\nlet lightbox;\nlet currentPage = 1;\n\nsearchForm.addEventListener(\"submit\", async function (e) {\n  e.preventDefault();\n  currentPage = 1;\n  const searchTerm = searchInput.value.trim();\n  if (searchTerm !== \"\") {\n    await searchImages(searchTerm);\n  }\n});\n\nbtnLoadMore.addEventListener(\"click\", handleLoadMore);\n\nfunction handleLoadMore() {\n  currentPage += 1;\n  const searchTerm = searchInput.value.trim();\n  if (searchTerm !== \"\") {\n    searchImages(searchTerm, currentPage);\n  }\n}\n\nasync function searchImages(searchTerm, page = 1) {\n  try {\n    const response = await performSearch(searchTerm, page);\n\n    if (response.data.hits.length > 0) {\n      if (page === 1) {\n        clearGallery();\n      }\n\n      displayImages(response.data.hits);\n      updateLightbox();\n      smoothScrollToGallery();\n    } else {\n      showNoResultsMessage();\n      clearGallery();\n      btnLoadMore.style.display = \"none\";\n    }\n\n    if (response.data.totalHits <= page * 40) {\n      showEndMessage();\n    }\n  } catch (error) {\n    console.error(\"Error fetching images:\", error);\n    hideLoader();\n    showErrorToast(\"An error occurred while fetching images. Please try again.\");\n  }\n}\n\nfunction clearGallery() {\n  gallery.innerHTML = \"\";\n}\n\nfunction updateLightbox() {\n  lightbox.refresh();\n}\n\nfunction smoothScrollToGallery() {\n  const firstImageHeight = gallery.querySelector(\".image-card a img\").clientHeight;\n\n  window.scrollBy({\n    top: firstImageHeight,\n    behavior: \"smooth\",\n  });\n}\n\nasync function performSearch(searchTerm, page) {\n  const apiUrl = `https://pixabay.com/api/?key=${apiKey}&q=${encodeURIComponent(\n    searchTerm\n  )}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=40`;\n\n  showLoader();\n\n  try {\n    const response = await axios.get(apiUrl);\n    hideLoader();\n    return response;\n  } catch (error) {\n    hideLoader();\n    throw error;\n  }\n}\n\nfunction displayImages(images) {\n  const fragment = document.createDocumentFragment();\n\n  images.forEach((image) => {\n    const imageCard = createImageCard(image);\n    fragment.appendChild(imageCard);\n  });\n\n  gallery.appendChild(fragment);\n\n  if (images.length > 0) {\n    btnLoadMore.style.display = \"block\";\n  } else {\n    btnLoadMore.style.display = \"none\";\n  }\n}\n\nfunction showLoader() {\n  loader.style.display = \"block\";\n}\n\nfunction hideLoader() {\n  loader.style.display = \"none\";\n}\n\nfunction createImageCard(image) {\n  const card = document.createElement(\"div\");\n  card.className = \"image-card\";\n  card.innerHTML = `\n    <a href=\"${image.largeImageURL}\" data-lightbox=\"gallery\">\n      <img src=\"${image.webformatURL}\" alt=\"${image.tags}\">\n    </a>\n    <div class=\"image-details\">\n      <p>Likes: ${image.likes}</p>\n      <p>Views: ${image.views}</p>\n      <p>Comments: ${image.comments}</p>\n      <p>Downloads: ${image.downloads}</p>\n    </div>\n  `;\n  return card;\n}\n\nfunction showNoResultsMessage() {\n  iziToast.info({\n    title: \"No Results\",\n    message: \"Sorry, there are no images matching your search query. Please try again!\",\n  });\n}\n\nfunction showErrorToast(message) {\n  iziToast.error({\n    title: \"Error\",\n    message: message,\n  });\n}\n\nfunction showEndMessage() {\n  iziToast.info({\n    title: \"End of Collection\",\n    message: \"We're sorry, but you've reached the end of search results.\",\n  });\n\n  btnLoadMore.style.display = \"none\";\n}\n\nfunction initLightbox() {\n  lightbox = new SimpleLightbox(\".image-card a\");\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", initLightbox);\n"],"names":["apiKey","searchForm","searchInput","loader","gallery","btnLoadMore","lightbox","currentPage","searchTerm","searchImages","handleLoadMore","page","response","performSearch","clearGallery","displayImages","updateLightbox","smoothScrollToGallery","showNoResultsMessage","showEndMessage","error","hideLoader","showErrorToast","firstImageHeight","apiUrl","showLoader","axios","images","fragment","image","imageCard","createImageCard","card","iziToast","message","initLightbox","SimpleLightbox"],"mappings":"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"}